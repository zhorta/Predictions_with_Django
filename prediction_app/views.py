from django.shortcuts import render
from django.http import HttpResponse
from django.http import JsonResponse

# Create your views here.
from django.views.decorators.csrf import csrf_exempt

from prediction_app.models import Posture
from prediction_app.serializers import PostureSerializer

from rest_framework.parsers import JSONParser
from rest_framework.renderers import JSONRenderer


def index(request):
    return HttpResponse("You are on the main page: isn't it beautiful?")


@csrf_exempt
def i_want_a_list(request):
    if request.method == 'GET':
        postures = Posture.objects.all()
        serializer = PostureSerializer(postures, many=True)
        return JsonResponse(serializer.data, safe=False)

    elif request.method == 'POST':
        content = JSONParser().parse(request)
        serializer = PostureSerializer(data=content)
        if serializer.is_valid():
            serializer.save()
            return JsonResponse(serializer.data, status=201)  # 201 => Created
        return JsonResponse(serializer.errors, status=400)  # 404 => Bad Request


@csrf_exempt
def posture_detail(request, posture_id):
    try:
        posture = Posture.objects.get(pk=posture_id)
    except Posture.DoesNotExist:
        return HttpResponse(str(posture_id), status=404)  # 404 => Not Found
    if request.method == 'GET':
        serializer = PostureSerializer(posture)
        return JsonResponse(serializer.data)
    elif request.method == 'PUT':
        content = JSONParser().parse(request)
        serializer = PostureSerializer(posture)
        serializer.update(posture, content)
        return JsonResponse(serializer.data, status=201)
    elif request.method == 'DELETE':
        posture.delete()
        return HttpResponse('Suppression faite !', status=204)  # 204 => No Content


def predict_posture(unscaled_data):
    from sklearn.externals import joblib
    colonnes = ['tBodyAccMean1',
                'tBodyAccMean2',
                'tBodyAccMean3',
                'tBodyAccSTD1',
                'tBodyAccSTD2',
                'tBodyAccSTD3',
                'tBodyAccMad1',
                'tBodyAccMad2',
                'tBodyAccMad3',
                'tBodyAccMax1',
                'tBodyAccMax2',
                'tBodyAccMax3',
                'tBodyAccMin1',
                'tBodyAccMin2',
                'tBodyAccMin3',
                'tBodyAccSMA1',
                'tBodyAccEnergy1',
                'tBodyAccEnergy2',
                'tBodyAccEnergy3',
                'tBodyAccIQR1',
                'tBodyAccIQR2',
                'tBodyAccIQR3',
                'tBodyAccropy1',
                'tBodyAccropy2',
                'tBodyAccropy3',
                'tBodyAccARCoeff1',
                'tBodyAccARCoeff2',
                'tBodyAccARCoeff3',
                'tBodyAccARCoeff4',
                'tBodyAccARCoeff5',
                'tBodyAccARCoeff6',
                'tBodyAccARCoeff7',
                'tBodyAccARCoeff8',
                'tBodyAccARCoeff9',
                'tBodyAccARCoeff10',
                'tBodyAccARCoeff11',
                'tBodyAccARCoeff12',
                'tBodyAccCorrelation1',
                'tBodyAccCorrelation2',
                'tBodyAccCorrelation3',
                'tGravityAccMean1',
                'tGravityAccMean2',
                'tGravityAccMean3',
                'tGravityAccSTD1',
                'tGravityAccSTD2',
                'tGravityAccSTD3',
                'tGravityAccMad1',
                'tGravityAccMad2',
                'tGravityAccMad3',
                'tGravityAccMax1',
                'tGravityAccMax2',
                'tGravityAccMax3',
                'tGravityAccMin1',
                'tGravityAccMin2',
                'tGravityAccMin3',
                'tGravityAccSMA1',
                'tGravityAccEnergy1',
                'tGravityAccEnergy2',
                'tGravityAccEnergy3',
                'tGravityAccIQR1',
                'tGravityAccIQR2',
                'tGravityAccIQR3',
                'tGravityAccropy1',
                'tGravityAccropy2',
                'tGravityAccropy3',
                'tGravityAccARCoeff1',
                'tGravityAccARCoeff2',
                'tGravityAccARCoeff3',
                'tGravityAccARCoeff4',
                'tGravityAccARCoeff5',
                'tGravityAccARCoeff6',
                'tGravityAccARCoeff7',
                'tGravityAccARCoeff8',
                'tGravityAccARCoeff9',
                'tGravityAccARCoeff10',
                'tGravityAccARCoeff11',
                'tGravityAccARCoeff12',
                'tGravityAccCorrelation1',
                'tGravityAccCorrelation2',
                'tGravityAccCorrelation3',
                'tBodyAccJerkMean1',
                'tBodyAccJerkMean2',
                'tBodyAccJerkMean3',
                'tBodyAccJerkSTD1',
                'tBodyAccJerkSTD2',
                'tBodyAccJerkSTD3',
                'tBodyAccJerkMad1',
                'tBodyAccJerkMad2',
                'tBodyAccJerkMad3',
                'tBodyAccJerkMax1',
                'tBodyAccJerkMax2',
                'tBodyAccJerkMax3',
                'tBodyAccJerkMin1',
                'tBodyAccJerkMin2',
                'tBodyAccJerkMin3',
                'tBodyAccJerkSMA1',
                'tBodyAccJerkEnergy1',
                'tBodyAccJerkEnergy2',
                'tBodyAccJerkEnergy3',
                'tBodyAccJerkIQR1',
                'tBodyAccJerkIQR2',
                'tBodyAccJerkIQR3',
                'tBodyAccJerkropy1',
                'tBodyAccJerkropy2',
                'tBodyAccJerkropy3',
                'tBodyAccJerkARCoeff1',
                'tBodyAccJerkARCoeff2',
                'tBodyAccJerkARCoeff3',
                'tBodyAccJerkARCoeff4',
                'tBodyAccJerkARCoeff5',
                'tBodyAccJerkARCoeff6',
                'tBodyAccJerkARCoeff7',
                'tBodyAccJerkARCoeff8',
                'tBodyAccJerkARCoeff9',
                'tBodyAccJerkARCoeff10',
                'tBodyAccJerkARCoeff11',
                'tBodyAccJerkARCoeff12',
                'tBodyAccJerkCorrelation1',
                'tBodyAccJerkCorrelation2',
                'tBodyAccJerkCorrelation3',
                'tBodyGyroMean1',
                'tBodyGyroMean2',
                'tBodyGyroMean3',
                'tBodyGyroSTD1',
                'tBodyGyroSTD2',
                'tBodyGyroSTD3',
                'tBodyGyroMad1',
                'tBodyGyroMad2',
                'tBodyGyroMad3',
                'tBodyGyroMax1',
                'tBodyGyroMax2',
                'tBodyGyroMax3',
                'tBodyGyroMin1',
                'tBodyGyroMin2',
                'tBodyGyroMin3',
                'tBodyGyroSMA1',
                'tBodyGyroEnergy1',
                'tBodyGyroEnergy2',
                'tBodyGyroEnergy3',
                'tBodyGyroIQR1',
                'tBodyGyroIQR2',
                'tBodyGyroIQR3',
                'tBodyGyroropy1',
                'tBodyGyroropy2',
                'tBodyGyroropy3',
                'tBodyGyroARCoeff1',
                'tBodyGyroARCoeff2',
                'tBodyGyroARCoeff3',
                'tBodyGyroARCoeff4',
                'tBodyGyroARCoeff5',
                'tBodyGyroARCoeff6',
                'tBodyGyroARCoeff7',
                'tBodyGyroARCoeff8',
                'tBodyGyroARCoeff9',
                'tBodyGyroARCoeff10',
                'tBodyGyroARCoeff11',
                'tBodyGyroARCoeff12',
                'tBodyGyroCorrelation1',
                'tBodyGyroCorrelation2',
                'tBodyGyroCorrelation3',
                'tBodyGyroJerkMean1',
                'tBodyGyroJerkMean2',
                'tBodyGyroJerkMean3',
                'tBodyGyroJerkSTD1',
                'tBodyGyroJerkSTD2',
                'tBodyGyroJerkSTD3',
                'tBodyGyroJerkMad1',
                'tBodyGyroJerkMad2',
                'tBodyGyroJerkMad3',
                'tBodyGyroJerkMax1',
                'tBodyGyroJerkMax2',
                'tBodyGyroJerkMax3',
                'tBodyGyroJerkMin1',
                'tBodyGyroJerkMin2',
                'tBodyGyroJerkMin3',
                'tBodyGyroJerkSMA1',
                'tBodyGyroJerkEnergy1',
                'tBodyGyroJerkEnergy2',
                'tBodyGyroJerkEnergy3',
                'tBodyGyroJerkIQR1',
                'tBodyGyroJerkIQR2',
                'tBodyGyroJerkIQR3',
                'tBodyGyroJerkropy1',
                'tBodyGyroJerkropy2',
                'tBodyGyroJerkropy3',
                'tBodyGyroJerkARCoeff1',
                'tBodyGyroJerkARCoeff2',
                'tBodyGyroJerkARCoeff3',
                'tBodyGyroJerkARCoeff4',
                'tBodyGyroJerkARCoeff5',
                'tBodyGyroJerkARCoeff6',
                'tBodyGyroJerkARCoeff7',
                'tBodyGyroJerkARCoeff8',
                'tBodyGyroJerkARCoeff9',
                'tBodyGyroJerkARCoeff10',
                'tBodyGyroJerkARCoeff11',
                'tBodyGyroJerkARCoeff12',
                'tBodyGyroJerkCorrelation1',
                'tBodyGyroJerkCorrelation2',
                'tBodyGyroJerkCorrelation3',
                'tBodyAccMagMean1',
                'tBodyAccMagSTD1',
                'tBodyAccMagMad1',
                'tBodyAccMagMax1',
                'tBodyAccMagMin1',
                'tBodyAccMagSMA1',
                'tBodyAccMagEnergy1',
                'tBodyAccMagIQR1',
                'tBodyAccMagropy1',
                'tBodyAccMagARCoeff1',
                'tBodyAccMagARCoeff2',
                'tBodyAccMagARCoeff3',
                'tBodyAccMagARCoeff4',
                'tGravityAccMagMean1',
                'tGravityAccMagSTD1',
                'tGravityAccMagMad1',
                'tGravityAccMagMax1',
                'tGravityAccMagMin1',
                'tGravityAccMagSMA1',
                'tGravityAccMagEnergy1',
                'tGravityAccMagIQR1',
                'tGravityAccMagropy1',
                'tGravityAccMagARCoeff1',
                'tGravityAccMagARCoeff2',
                'tGravityAccMagARCoeff3',
                'tGravityAccMagARCoeff4',
                'tBodyAccJerkMagMean1',
                'tBodyAccJerkMagSTD1',
                'tBodyAccJerkMagMad1',
                'tBodyAccJerkMagMax1',
                'tBodyAccJerkMagMin1',
                'tBodyAccJerkMagSMA1',
                'tBodyAccJerkMagEnergy1',
                'tBodyAccJerkMagIQR1',
                'tBodyAccJerkMagropy1',
                'tBodyAccJerkMagARCoeff1',
                'tBodyAccJerkMagARCoeff2',
                'tBodyAccJerkMagARCoeff3',
                'tBodyAccJerkMagARCoeff4',
                'tBodyGyroMagMean1',
                'tBodyGyroMagSTD1',
                'tBodyGyroMagMad1',
                'tBodyGyroMagMax1',
                'tBodyGyroMagMin1',
                'tBodyGyroMagSMA1',
                'tBodyGyroMagEnergy1',
                'tBodyGyroMagIQR1',
                'tBodyGyroMagropy1',
                'tBodyGyroMagARCoeff1',
                'tBodyGyroMagARCoeff2',
                'tBodyGyroMagARCoeff3',
                'tBodyGyroMagARCoeff4',
                'tBodyGyroJerkMagMean1',
                'tBodyGyroJerkMagSTD1',
                'tBodyGyroJerkMagMad1',
                'tBodyGyroJerkMagMax1',
                'tBodyGyroJerkMagMin1',
                'tBodyGyroJerkMagSMA1',
                'tBodyGyroJerkMagEnergy1',
                'tBodyGyroJerkMagIQR1',
                'tBodyGyroJerkMagropy1',
                'tBodyGyroJerkMagARCoeff1',
                'tBodyGyroJerkMagARCoeff2',
                'tBodyGyroJerkMagARCoeff3',
                'tBodyGyroJerkMagARCoeff4',
                'fBodyAccMean1',
                'fBodyAccMean2',
                'fBodyAccMean3',
                'fBodyAccSTD1',
                'fBodyAccSTD2',
                'fBodyAccSTD3',
                'fBodyAccMad1',
                'fBodyAccMad2',
                'fBodyAccMad3',
                'fBodyAccMax1',
                'fBodyAccMax2',
                'fBodyAccMax3',
                'fBodyAccMin1',
                'fBodyAccMin2',
                'fBodyAccMin3',
                'fBodyAccSMA1',
                'fBodyAccEnergy1',
                'fBodyAccEnergy2',
                'fBodyAccEnergy3',
                'fBodyAccIQR1',
                'fBodyAccIQR2',
                'fBodyAccIQR3',
                'fBodyAccropy1',
                'fBodyAccropy2',
                'fBodyAccropy3',
                'fBodyAccMaxInds1',
                'fBodyAccMaxInds2',
                'fBodyAccMaxInds3',
                'fBodyAccMeanFreq1',
                'fBodyAccMeanFreq2',
                'fBodyAccMeanFreq3',
                'fBodyAccSkewness1',
                'fBodyAccKurtosis1',
                'fBodyAccSkewness2',
                'fBodyAccKurtosis2',
                'fBodyAccSkewness3',
                'fBodyAccKurtosis3',
                'fBodyAccBandsEnergyOld1',
                'fBodyAccBandsEnergyOld2',
                'fBodyAccBandsEnergyOld3',
                'fBodyAccBandsEnergyOld4',
                'fBodyAccBandsEnergyOld5',
                'fBodyAccBandsEnergyOld6',
                'fBodyAccBandsEnergyOld7',
                'fBodyAccBandsEnergyOld8',
                'fBodyAccBandsEnergyOld9',
                'fBodyAccBandsEnergyOld10',
                'fBodyAccBandsEnergyOld11',
                'fBodyAccBandsEnergyOld12',
                'fBodyAccBandsEnergyOld13',
                'fBodyAccBandsEnergyOld14',
                'fBodyAccBandsEnergyOld15',
                'fBodyAccBandsEnergyOld16',
                'fBodyAccBandsEnergyOld17',
                'fBodyAccBandsEnergyOld18',
                'fBodyAccBandsEnergyOld19',
                'fBodyAccBandsEnergyOld20',
                'fBodyAccBandsEnergyOld21',
                'fBodyAccBandsEnergyOld22',
                'fBodyAccBandsEnergyOld23',
                'fBodyAccBandsEnergyOld24',
                'fBodyAccBandsEnergyOld25',
                'fBodyAccBandsEnergyOld26',
                'fBodyAccBandsEnergyOld27',
                'fBodyAccBandsEnergyOld28',
                'fBodyAccBandsEnergyOld29',
                'fBodyAccBandsEnergyOld30',
                'fBodyAccBandsEnergyOld31',
                'fBodyAccBandsEnergyOld32',
                'fBodyAccBandsEnergyOld33',
                'fBodyAccBandsEnergyOld34',
                'fBodyAccBandsEnergyOld35',
                'fBodyAccBandsEnergyOld36',
                'fBodyAccBandsEnergyOld37',
                'fBodyAccBandsEnergyOld38',
                'fBodyAccBandsEnergyOld39',
                'fBodyAccBandsEnergyOld40',
                'fBodyAccBandsEnergyOld41',
                'fBodyAccBandsEnergyOld42',
                'fBodyAccJerkMean1',
                'fBodyAccJerkMean2',
                'fBodyAccJerkMean3',
                'fBodyAccJerkSTD1',
                'fBodyAccJerkSTD2',
                'fBodyAccJerkSTD3',
                'fBodyAccJerkMad1',
                'fBodyAccJerkMad2',
                'fBodyAccJerkMad3',
                'fBodyAccJerkMax1',
                'fBodyAccJerkMax2',
                'fBodyAccJerkMax3',
                'fBodyAccJerkMin1',
                'fBodyAccJerkMin2',
                'fBodyAccJerkMin3',
                'fBodyAccJerkSMA1',
                'fBodyAccJerkEnergy1',
                'fBodyAccJerkEnergy2',
                'fBodyAccJerkEnergy3',
                'fBodyAccJerkIQR1',
                'fBodyAccJerkIQR2',
                'fBodyAccJerkIQR3',
                'fBodyAccJerkropy1',
                'fBodyAccJerkropy2',
                'fBodyAccJerkropy3',
                'fBodyAccJerkMaxInds1',
                'fBodyAccJerkMaxInds2',
                'fBodyAccJerkMaxInds3',
                'fBodyAccJerkMeanFreq1',
                'fBodyAccJerkMeanFreq2',
                'fBodyAccJerkMeanFreq3',
                'fBodyAccJerkSkewness1',
                'fBodyAccJerkKurtosis1',
                'fBodyAccJerkSkewness2',
                'fBodyAccJerkKurtosis2',
                'fBodyAccJerkSkewness3',
                'fBodyAccJerkKurtosis3',
                'fBodyAccJerkBandsEnergyOld1',
                'fBodyAccJerkBandsEnergyOld2',
                'fBodyAccJerkBandsEnergyOld3',
                'fBodyAccJerkBandsEnergyOld4',
                'fBodyAccJerkBandsEnergyOld5',
                'fBodyAccJerkBandsEnergyOld6',
                'fBodyAccJerkBandsEnergyOld7',
                'fBodyAccJerkBandsEnergyOld8',
                'fBodyAccJerkBandsEnergyOld9',
                'fBodyAccJerkBandsEnergyOld10',
                'fBodyAccJerkBandsEnergyOld11',
                'fBodyAccJerkBandsEnergyOld12',
                'fBodyAccJerkBandsEnergyOld13',
                'fBodyAccJerkBandsEnergyOld14',
                'fBodyAccJerkBandsEnergyOld15',
                'fBodyAccJerkBandsEnergyOld16',
                'fBodyAccJerkBandsEnergyOld17',
                'fBodyAccJerkBandsEnergyOld18',
                'fBodyAccJerkBandsEnergyOld19',
                'fBodyAccJerkBandsEnergyOld20',
                'fBodyAccJerkBandsEnergyOld21',
                'fBodyAccJerkBandsEnergyOld22',
                'fBodyAccJerkBandsEnergyOld23',
                'fBodyAccJerkBandsEnergyOld24',
                'fBodyAccJerkBandsEnergyOld25',
                'fBodyAccJerkBandsEnergyOld26',
                'fBodyAccJerkBandsEnergyOld27',
                'fBodyAccJerkBandsEnergyOld28',
                'fBodyAccJerkBandsEnergyOld29',
                'fBodyAccJerkBandsEnergyOld30',
                'fBodyAccJerkBandsEnergyOld31',
                'fBodyAccJerkBandsEnergyOld32',
                'fBodyAccJerkBandsEnergyOld33',
                'fBodyAccJerkBandsEnergyOld34',
                'fBodyAccJerkBandsEnergyOld35',
                'fBodyAccJerkBandsEnergyOld36',
                'fBodyAccJerkBandsEnergyOld37',
                'fBodyAccJerkBandsEnergyOld38',
                'fBodyAccJerkBandsEnergyOld39',
                'fBodyAccJerkBandsEnergyOld40',
                'fBodyAccJerkBandsEnergyOld41',
                'fBodyAccJerkBandsEnergyOld42',
                'fBodyGyroMean1',
                'fBodyGyroMean2',
                'fBodyGyroMean3',
                'fBodyGyroSTD1',
                'fBodyGyroSTD2',
                'fBodyGyroSTD3',
                'fBodyGyroMad1',
                'fBodyGyroMad2',
                'fBodyGyroMad3',
                'fBodyGyroMax1',
                'fBodyGyroMax2',
                'fBodyGyroMax3',
                'fBodyGyroMin1',
                'fBodyGyroMin2',
                'fBodyGyroMin3',
                'fBodyGyroSMA1',
                'fBodyGyroEnergy1',
                'fBodyGyroEnergy2',
                'fBodyGyroEnergy3',
                'fBodyGyroIQR1',
                'fBodyGyroIQR2',
                'fBodyGyroIQR3',
                'fBodyGyroropy1',
                'fBodyGyroropy2',
                'fBodyGyroropy3',
                'fBodyGyroMaxInds1',
                'fBodyGyroMaxInds2',
                'fBodyGyroMaxInds3',
                'fBodyGyroMeanFreq1',
                'fBodyGyroMeanFreq2',
                'fBodyGyroMeanFreq3',
                'fBodyGyroSkewness1',
                'fBodyGyroKurtosis1',
                'fBodyGyroSkewness2',
                'fBodyGyroKurtosis2',
                'fBodyGyroSkewness3',
                'fBodyGyroKurtosis3',
                'fBodyGyroBandsEnergyOld1',
                'fBodyGyroBandsEnergyOld2',
                'fBodyGyroBandsEnergyOld3',
                'fBodyGyroBandsEnergyOld4',
                'fBodyGyroBandsEnergyOld5',
                'fBodyGyroBandsEnergyOld6',
                'fBodyGyroBandsEnergyOld7',
                'fBodyGyroBandsEnergyOld8',
                'fBodyGyroBandsEnergyOld9',
                'fBodyGyroBandsEnergyOld10',
                'fBodyGyroBandsEnergyOld11',
                'fBodyGyroBandsEnergyOld12',
                'fBodyGyroBandsEnergyOld13',
                'fBodyGyroBandsEnergyOld14',
                'fBodyGyroBandsEnergyOld15',
                'fBodyGyroBandsEnergyOld16',
                'fBodyGyroBandsEnergyOld17',
                'fBodyGyroBandsEnergyOld18',
                'fBodyGyroBandsEnergyOld19',
                'fBodyGyroBandsEnergyOld20',
                'fBodyGyroBandsEnergyOld21',
                'fBodyGyroBandsEnergyOld22',
                'fBodyGyroBandsEnergyOld23',
                'fBodyGyroBandsEnergyOld24',
                'fBodyGyroBandsEnergyOld25',
                'fBodyGyroBandsEnergyOld26',
                'fBodyGyroBandsEnergyOld27',
                'fBodyGyroBandsEnergyOld28',
                'fBodyGyroBandsEnergyOld29',
                'fBodyGyroBandsEnergyOld30',
                'fBodyGyroBandsEnergyOld31',
                'fBodyGyroBandsEnergyOld32',
                'fBodyGyroBandsEnergyOld33',
                'fBodyGyroBandsEnergyOld34',
                'fBodyGyroBandsEnergyOld35',
                'fBodyGyroBandsEnergyOld36',
                'fBodyGyroBandsEnergyOld37',
                'fBodyGyroBandsEnergyOld38',
                'fBodyGyroBandsEnergyOld39',
                'fBodyGyroBandsEnergyOld40',
                'fBodyGyroBandsEnergyOld41',
                'fBodyGyroBandsEnergyOld42',
                'fBodyAccMagMean1',
                'fBodyAccMagSTD1',
                'fBodyAccMagMad1',
                'fBodyAccMagMax1',
                'fBodyAccMagMin1',
                'fBodyAccMagSMA1',
                'fBodyAccMagEnergy1',
                'fBodyAccMagIQR1',
                'fBodyAccMagropy1',
                'fBodyAccMagMaxInds1',
                'fBodyAccMagMeanFreq1',
                'fBodyAccMagSkewness1',
                'fBodyAccMagKurtosis1',
                'fBodyAccJerkMagMean1',
                'fBodyAccJerkMagSTD1',
                'fBodyAccJerkMagMad1',
                'fBodyAccJerkMagMax1',
                'fBodyAccJerkMagMin1',
                'fBodyAccJerkMagSMA1',
                'fBodyAccJerkMagEnergy1',
                'fBodyAccJerkMagIQR1',
                'fBodyAccJerkMagropy1',
                'fBodyAccJerkMagMaxInds1',
                'fBodyAccJerkMagMeanFreq1',
                'fBodyAccJerkMagSkewness1',
                'fBodyAccJerkMagKurtosis1',
                'fBodyGyroMagMean1',
                'fBodyGyroMagSTD1',
                'fBodyGyroMagMad1',
                'fBodyGyroMagMax1',
                'fBodyGyroMagMin1',
                'fBodyGyroMagSMA1',
                'fBodyGyroMagEnergy1',
                'fBodyGyroMagIQR1',
                'fBodyGyroMagropy1',
                'fBodyGyroMagMaxInds1',
                'fBodyGyroMagMeanFreq1',
                'fBodyGyroMagSkewness1',
                'fBodyGyroMagKurtosis1',
                'fBodyGyroJerkMagMean1',
                'fBodyGyroJerkMagSTD1',
                'fBodyGyroJerkMagMad1',
                'fBodyGyroJerkMagMax1',
                'fBodyGyroJerkMagMin1',
                'fBodyGyroJerkMagSMA1',
                'fBodyGyroJerkMagEnergy1',
                'fBodyGyroJerkMagIQR1',
                'fBodyGyroJerkMagropy1',
                'fBodyGyroJerkMagMaxInds1',
                'fBodyGyroJerkMagMeanFreq1',
                'fBodyGyroJerkMagSkewness1',
                'fBodyGyroJerkMagKurtosis1',
                'tBodyAccAngleWRTGravity1',
                'tBodyAccJerkAngleWRTGravity1',
                'tBodyGyroAngleWRTGravity1',
                'tBodyGyroJerkAngleWRTGravity1',
                'tXAxisAccAngleWRTGravity1',
                'tYAxisAccAngleWRTGravity1',
                'tZAxisAccAngleWRTGravity1']
    path_to_model = '/Users/zoehorta/PycharmProjects/Predictions_with_Django/best_posture_prediction_model.joblib'
    unscaled_data = [unscaled_data[colonne] for colonne in colonnes]
    model = joblib.load(path_to_model)
    posture = model.predict([unscaled_data])
    return posture


@csrf_exempt
def predict(request):
    if request.method == 'GET':
        content = JSONParser().parse(request)
        serializer = PostureSerializer(data=content)
        return JsonResponse(serializer.errors, status=404)
    elif request.method == 'POST':
        data = JSONParser().parse(request)
        serializer = PostureSerializer(data=data)
        if serializer.is_valid():
            data["posture"] = predict_posture(data)
            serializer = PostureSerializer(data=data)
            if serializer.is_valid():
                serializer.save()
                return JsonResponse(serializer.data, status=201)
        return JsonResponse(serializer.errors, status=400)
